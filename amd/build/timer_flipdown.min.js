/**
 * Implementaton of the quizaccess_delayed timer JScript.
 * Based on quizaccess_activateattempt https://github.com/IITBombayWeb/moodle-quizaccess_delayed/tree/v1.0.3
 *
 * @package   quizaccess_delayed
 * @author    Juan Pablo de Castro
 * @copyright 2020 University of Valladolid, Spain
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define(["jquery"],(function(t){var e,i;return{get_string:function(t,i,n=null){return e[t]},set_strings:function(t){e=t},init:function(e=".continuebutton",n,a,d,s,r,p){if(t(".quizattempt #delayednotification").length>0)return!1;this.set_strings(p),i=(new Date).getTime()+r,t("<link>").appendTo("head").attr({type:"text/css",rel:"stylesheet",href:"accessrule/delayed/flipdown/flipdown.css"}),jQuery.getScript("accessrule/delayed/flipdown/flipdown.js",this.startCounter.bind(this));var o=t("<center>"+p.quizwillstartinabout+'<div id="flipdown" class="flipdown"></div><p>'+p.pleasewait+"</p></center>"),l=t("<form/>",{method:"post",action:n}).append(t("<input>",{type:"hidden",name:"cmid",value:a}),t("<input>",{type:"hidden",name:"sesskey",value:d}),t("<p>",{id:"activatedelayedtimer"}),t("<input>",{type:"submit",class:"btn btn-primary",id:"startAttemptButton",disabled:!0,value:s})),u=t('<div id="delayednotification"/>').append(o);t(e).prepend(l,t("</br>")),t(e).prepend(u),t("[id=startAttemptButton]").prop("disabled",!0)},startCounter:function(){new FlipDown(i/1e3,{theme:"dark",headings:["","","",""]}).start().ifEnded(this.activateAttempt),t("#flipdown").width(32*t("#flipdown").find(".rotor").length)},activateAttempt:function(){var t=(new Date).getTime();i-t<0?location.reload():setTimeout(this.activateAttempt,1e3)}}}));